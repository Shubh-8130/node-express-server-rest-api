pipeline {
    agent any
    
    stages {
        stage('Checkout') {
            steps {
                // Checkout the code from your repository
                checkout([$class: 'GitSCM', branches: [[name: 'master']], userRemoteConfigs: [[url: 'https://github.com/Shubh-8130/node-express-server-rest-api.git']]])
            }
        }
        
        stage('Build and Deploy') {
            steps {
                // Connect to the server using SSH and execute commands
                script {
                    // Execute commands on the remote server
                    sh '''
                        ssh -i /Users/shubhamsharma/jenkins/my-key-terr.pem ubuntu@54.156.64.233
                        cd ~/node-express-server-rest-api
                        sudo apt update -y
                        sudo apt install nodejs npm -y
                        npm install -y
                        npm update -y
                        npm start
                    '''
                }
            }
        }
    }
}
